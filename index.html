<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Fragment Vault</title>
  <style>
    :root{
      --bg:#070A12;
      --panel:rgba(255,255,255,.06);
      --panel2:rgba(255,255,255,.09);
      --text:#EAF0FF;
      --muted:rgba(234,240,255,.65);
      --good:#57f287;
      --warn:#ffcc66;
      --bad:#ff5c7a;
      --line:rgba(255,255,255,.12);
      --glow: 0 0 30px rgba(120,160,255,.18);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh;
      font-family:var(--sans); color:var(--text);
      background:
        radial-gradient(1200px 600px at 20% 10%, rgba(86,140,255,.18), transparent 60%),
        radial-gradient(900px 600px at 80% 30%, rgba(255,110,200,.12), transparent 55%),
        radial-gradient(900px 700px at 50% 90%, rgba(120,255,220,.10), transparent 60%),
        linear-gradient(180deg, #04060c 0%, #070A12 100%);
      overflow-x:hidden;
    }
    .wrap{ width:min(1050px, 94vw); margin:0 auto; padding:26px 0 30px; }
    header{ padding:0 0 8px; }
    h1{
      margin:0;
      letter-spacing:.08em;
      text-transform:uppercase;
      font-weight:950;
      font-size: clamp(22px, 3.1vw, 34px);
      text-shadow: var(--glow);
    }
    .subhead{
      margin:10px 0 0;
      color:var(--muted);
      font-size:13px;
      line-height:1.4;
      max-width: 75ch;
    }
    .grid{
      margin-top:14px;
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:14px;
    }
    @media (max-width: 900px){ .grid{grid-template-columns:1fr;} }

    .card{
      background: var(--panel);
      border:1px solid var(--line);
      border-radius:18px;
      padding:16px;
      box-shadow: var(--glow);
      backdrop-filter: blur(8px);
    }
    .card h2{
      margin:0 0 10px;
      font-size:15px;
      letter-spacing:.06em;
      text-transform:uppercase;
      color: rgba(234,240,255,.9);
    }
    .hint{
      color:var(--muted);
      font-size:13px;
      line-height:1.45;
      margin:0 0 12px;
    }
    .panel{
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.10);
      border-radius:14px;
      padding:12px;
      font-family:var(--mono);
      font-size:13px;
      line-height:1.55;
    }
    .row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top:10px; }
    input{
      flex:1; min-width: 220px;
      padding:12px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color: var(--text);
      outline:none;
      font-size:14px;
    }
    input:focus{
      border-color: rgba(120, 160, 255, .55);
      box-shadow: 0 0 0 3px rgba(120,160,255,.15);
    }
    button{
      padding:12px 14px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.10);
      color: var(--text);
      cursor:pointer;
      font-weight:850;
      letter-spacing:.02em;
      transition: transform .12s ease, background .2s ease;
      user-select:none;
    }
    button:hover{ background: rgba(255,255,255,.14); }
    button:active{ transform: translateY(1px) scale(.99); }
    .hintbtn{
      background: rgba(255, 204, 102, .10);
      border-color: rgba(255, 204, 102, .25);
    }
    .status{ margin-top:10px; font-size:13px; color:var(--muted); min-height: 20px; }
    .status.good{ color: var(--good); }
    .status.bad{ color: var(--bad); }
    .status.warn{ color: var(--warn); }

    .chips{ display:flex; gap:8px; flex-wrap:wrap; }
    .chip{
      font-family:var(--mono);
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.20);
      color: var(--muted);
    }
    .chip.on{
      color: rgba(255,255,255,.95);
      border-color: rgba(87,242,135,.35);
      background: rgba(87,242,135,.10);
    }

    .piece{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:12px; border-radius:14px;
      border:1px dashed rgba(255,255,255,.18);
      background: rgba(0,0,0,.18);
      margin-top:10px;
      font-family:var(--mono);
    }
    .piece .label{
      font-size:12px;
      letter-spacing:.12em;
      text-transform:uppercase;
      color: rgba(234,240,255,.60);
    }
    .piece .val{
      font-size:14px;
      font-weight:900;
      letter-spacing:.14em;
      color: rgba(234,240,255,.95);
    }
    .piece .val.muted{ color: rgba(234,240,255,.35); font-weight:700; }

    .final{
      margin-top:12px;
      padding:14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      min-height: 180px;
      display:flex;
      align-items:center;
      justify-content:center;
      text-align:center;
    }

    .small{
      font-family:var(--mono);
      font-size:12px;
      color: rgba(234,240,255,.55);
      line-height:1.5;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Fragment Vault</h1>
      <p class="subhead">
        None of the questions are about the destination. They only give you <b>number tokens</b>.
        Convert the tokens with <b>A1Z26</b> to build a key, then use the key to decrypt the dossier.
      </p>
    </header>

    <div class="grid">
      <!-- LEFT: MINI PUZZLES -->
      <section class="card">
        <h2>Token 1 — Time</h2>
        <p class="hint">How many minutes are in half of a half-hour?</p>
        <div class="panel">Answer with a number from 1–26.</div>
        <div class="row">
          <input id="a1" placeholder="token 1 number" inputmode="numeric" autocomplete="off">
          <button onclick="check(1)">Submit</button>
          <button class="hintbtn" onclick="hint(1)">Hint</button>
        </div>
        <div class="status" id="s1"></div>

        <div style="height:10px"></div>

        <h2>Token 2 — Sports</h2>
        <p class="hint">How many holes are in a standard round of golf?</p>
        <div class="panel">Answer with a number from 1–26.</div>
        <div class="row">
          <input id="a2" placeholder="token 2 number" inputmode="numeric" autocomplete="off">
          <button onclick="check(2)">Submit</button>
          <button class="hintbtn" onclick="hint(2)">Hint</button>
        </div>
        <div class="status" id="s2"></div>

        <div style="height:10px"></div>

        <h2>Token 3 — Astronomy</h2>
        <p class="hint">How many moons does Mars have?</p>
        <div class="panel">Answer with a number from 1–26.</div>
        <div class="row">
          <input id="a3" placeholder="token 3 number" inputmode="numeric" autocomplete="off">
          <button onclick="check(3)">Submit</button>
          <button class="hintbtn" onclick="hint(3)">Hint</button>
        </div>
        <div class="status" id="s3"></div>

        <div style="height:10px"></div>

        <h2>Token 4 — Baseball</h2>
        <p class="hint">How many innings are in a standard baseball game?</p>
        <div class="panel">Answer with a number from 1–26.</div>
        <div class="row">
          <input id="a4" placeholder="token 4 number" inputmode="numeric" autocomplete="off">
          <button onclick="check(4)">Submit</button>
          <button class="hintbtn" onclick="hint(4)">Hint</button>
        </div>
        <div class="status" id="s4"></div>

        <div style="height:10px"></div>

        <h2>Token 5 — Geometry</h2>
        <p class="hint">How many faces does an icosahedron have?</p>
        <div class="panel">Answer with a number from 1–26.</div>
        <div class="row">
          <input id="a5" placeholder="token 5 number" inputmode="numeric" autocomplete="off">
          <button onclick="check(5)">Submit</button>
          <button class="hintbtn" onclick="hint(5)">Hint</button>
        </div>
        <div class="status" id="s5"></div>
      </section>

      <!-- RIGHT: TOKENS + DECRYPT -->
      <aside class="card">
        <h2>Collected tokens</h2>
        <p class="hint">
          Tokens are numbers 1–26. Convert them using A1Z26 to make a 5-letter key.
          (Example: 1=A, 2=B, 26=Z)
        </p>

        <div class="chips">
          <span class="chip" id="c1">T1</span>
          <span class="chip" id="c2">T2</span>
          <span class="chip" id="c3">T3</span>
          <span class="chip" id="c4">T4</span>
          <span class="chip" id="c5">T5</span>
        </div>

        <div class="piece"><div class="label">Token 1</div><div class="val muted" id="t1">__</div></div>
        <div class="piece"><div class="label">Token 2</div><div class="val muted" id="t2">__</div></div>
        <div class="piece"><div class="label">Token 3</div><div class="val muted" id="t3">__</div></div>
        <div class="piece"><div class="label">Token 4</div><div class="val muted" id="t4">__</div></div>
        <div class="piece"><div class="label">Token 5</div><div class="val muted" id="t5">__</div></div>

        <div style="height:12px"></div>

        <div class="panel">
          <div style="color:rgba(234,240,255,.80); margin-bottom:8px;">DOSSIER (encrypted)</div>
          <div id="cipher" style="letter-spacing:.10em;">KRTPBBXUWG RT</div>
          <div class="small" style="margin-top:8px;">
            This is a Vigenère cipher (A–Z). You can’t brute-force it here—earn the key.
          </div>
        </div>

        <div class="row" style="margin-top:12px;">
          <input id="key" placeholder="enter 5-letter key" autocomplete="off">
          <button onclick="unlock()">Decrypt</button>
        </div>
        <div class="status" id="sk"></div>

        <div class="final" id="final">
          <div style="color:rgba(234,240,255,.50)">
            Decrypted destination will appear here.
          </div>
        </div>
      </aside>
    </div>
  </div>

  <script>
    // --- Correct token answers (numbers 1–26) ---
    // Not related to the destination; they form a key only after A1Z26 conversion.
    const SOL = { 1:15, 2:18, 3:2, 4:9, 5:20 };

    // Ciphertext is shown; plaintext is NOT stored as plain text.
    const CIPHER = "KRTPBBXUWG RT";

    const got = {1:null,2:null,3:null,4:null,5:null};
    const hints = {1:0,2:0,3:0,4:0,5:0};

    function normNum(x){
      const n = parseInt(String(x).trim(), 10);
      if (!Number.isFinite(n)) return null;
      return n;
    }

    function setStatus(id, msg, type){
      const el = document.getElementById(id);
      el.textContent = msg;
      el.className = "status" + (type ? " " + type : "");
    }

    function markToken(i, val){
      got[i] = val;
      const chip = document.getElementById("c"+i);
      chip.classList.add("on");
      const t = document.getElementById("t"+i);
      t.textContent = String(val).padStart(2,"0");
      t.classList.remove("muted");
    }

    function allTokens(){
      return [1,2,3,4,5].every(i => got[i] !== null);
    }

    function check(i){
      const input = document.getElementById("a"+i);
      const n = normNum(input.value);
      if (n === null){
        setStatus("s"+i, "Type a number.", "warn");
        return;
      }
      if (n < 1 || n > 26){
        setStatus("s"+i, "Keep it between 1 and 26.", "warn");
        return;
      }
      if (n === SOL[i]){
        markToken(i, n);
        setStatus("s"+i, "Token secured.", "good");
        if (allTokens()){
          setStatus("sk", "All tokens collected. Convert them with A1Z26 to build the 5-letter key.", "warn");
        }
      } else {
        setStatus("s"+i, "Incorrect. Try again.", "bad");
      }
    }

    function hint(i){
      hints[i]++;
      const msgs = {
        1: [
          "Half of a half-hour is half of 30 minutes.",
          "Half of 30 is 15."
        ],
        2: [
          "A standard golf course has the same number of holes as a full scorecard.",
          "It’s 18."
        ],
        3: [
          "Mars has two small moons with names from mythology.",
          "Phobos and Deimos = 2."
        ],
        4: [
          "A normal game (not extras) has 9 innings.",
          "It’s 9."
        ],
        5: [
          "An icosahedron is one of the Platonic solids.",
          "It has 20 faces."
        ]
      };
      const m = msgs[i][Math.min(hints[i]-1, msgs[i].length-1)];
      setStatus("s"+i, m, "warn");
    }

    // --- Vigenère decrypt (A–Z only; spaces preserved) ---
    function vigenereDecrypt(cipher, key){
      const A = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      const k = key.toUpperCase().replace(/[^A-Z]/g,"");
      if (!k) return "";
      let out = "";
      let ki = 0;
      for (const ch of cipher.toUpperCase()){
        if (A.includes(ch)){
          const c = A.indexOf(ch);
          const kk = A.indexOf(k[ki % k.length]);
          const p = (c - kk + 26) % 26;
          out += A[p];
          ki++;
        } else {
          out += ch;
        }
      }
      return out;
    }

    function unlock(){
      const raw = (document.getElementById("key").value || "").trim().toUpperCase();
      if (!allTokens()){
        setStatus("sk", "You don’t have all the tokens yet.", "bad");
        return;
      }
      if (!/^[A-Z]{5}$/.test(raw)){
        setStatus("sk", "Key must be 5 letters (A–Z).", "warn");
        return;
      }

      // Compute the “earned” key from tokens via A1Z26 (no direct place clue).
      const A = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      const earned =
        A[got[1]-1] + A[got[2]-1] + A[got[3]-1] + A[got[4]-1] + A[got[5]-1];

      if (raw !== earned){
        setStatus("sk", "Wrong key. Check your A1Z26 conversion.", "bad");
        return;
      }

      const plain = vigenereDecrypt(CIPHER, raw); // yields the destination phrase
      setStatus("sk", "Decrypted.", "good");

      document.getElementById("final").innerHTML = `
        <div>
          <div style="font-size:12px; letter-spacing:.14em; text-transform:uppercase; color:rgba(234,240,255,.65)">
            Destination
          </div>
          <div style="margin-top:10px; font-size:26px; font-weight:950; letter-spacing:.08em; text-shadow: var(--glow);">
            ${plain.replace(" DC", ", D.C.")}
          </div>
          <div style="margin-top:10px; color:rgba(234,240,255,.70)">
            You earned the key first — then the location.
          </div>
        </div>
      `;
    }

    // Enter key submits the current field
    document.addEventListener("keydown", (e)=>{
      if (e.key !== "Enter") return;
      const id = document.activeElement?.id || "";
      if (id.startsWith("a")) check(parseInt(id.slice(1),10));
      if (id === "key") unlock();
    });
  </script>
</body>
</html>
